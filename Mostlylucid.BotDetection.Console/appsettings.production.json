{
  // ==========================================
  // SIGNATURE LOGGING CONFIGURATION
  // ==========================================

  "SignatureLogging": {
    // Enable signature logging to JSONL files
    "Enabled": true,
    // Minimum confidence score to log (0.0-1.0)
    // Only signatures >= this threshold are logged
    "MinConfidence": 0.7,
    // Pretty-print JSON-LD output (for demos and debugging)
    // Set to false in production for compact logs
    "PrettyPrintJsonLd": false,
    // HMAC-SHA256 key for privacy-safe signature hashing
    // CRITICAL: Generate a secure random key for production!
    // Use: openssl rand -base64 32
    // This key MUST be kept secret and stored securely (Key Vault, env var)
    "SignatureHashKey": "CHANGE_ME_IN_PRODUCTION_USE_SECURE_RANDOM_KEY_HERE"
  },
  "BotDetection": {
    // ==========================================
    // GLOBAL SETTINGS
    // ==========================================

    // Default policy to use when no specific policy is matched
    // Options: "production", "demo", "default", or any custom policy name
    "DefaultPolicyName": "production",
    // Default action policy for handling detected bots
    // Options: "block", "block-hard", "throttle", "logonly", etc.
    "DefaultActionPolicyName": "block",
    // Enable background learning and signature updates
    // When true: detections feed into ML models and signature database
    // When false: read-only mode, no learning
    "EnableLearning": true,
    // ==========================================
    // DETECTION POLICIES
    // ==========================================
    // Each policy defines WHICH detectors run and HOW they're orchestrated
    // Policies can be mapped to paths, endpoints, or selected via headers

    "Policies": {
      "production": {
        "Description": "PRODUCTION MODE - Full detection pipeline with blocking",
        // FAST PATH DETECTORS (Wave 0)
        // Run synchronously on every request, expected to complete <100ms
        // These detectors use cached data and quick pattern matching
        "FastPath": [
          "FastPathReputation",
          // Check cached signatures for instant allow/block
          "UserAgent",
          // Analyze User-Agent header for bot patterns
          "Header",
          // Check HTTP headers for anomalies
          "Ip",
          // IP reputation, datacenter detection, VPN/proxy
          "SecurityTool"
          // Detect security scanners (Acunetix, SQLMap, etc.)
        ],
        // SLOW PATH DETECTORS (Wave 1+)
        // Run asynchronously when fast path is inconclusive
        // These detectors perform deeper analysis (fingerprinting, correlation)
        "SlowPath": [
          "Behavioral",
          // Analyze request patterns, timing, cookies
          "AdvancedBehavioral",
          // Deep behavioral analysis with ML features
          "ClientSide",
          // JavaScript capabilities, WebGL, Canvas
          "Inconsistency",
          // Header/UA mismatches, impossible combinations
          "VersionAge",
          // Detect outdated browser versions
          "Http2Fingerprint",
          // HTTP/2 frame analysis (SETTINGS, PRIORITY)
          "TlsFingerprint",
          // TLS cipher suites and handshake patterns
          "TcpIpFingerprint",
          // TCP/IP stack fingerprinting
          "MultiLayerCorrelation",
          // Cross-layer consistency checks
          "BehavioralWaveform"
          // Request timing waveform analysis
        ],
        // AI PATH DETECTORS (Escalation only)
        // Only run when escalated due to high uncertainty
        // These are expensive detectors (ONNX models, LLM calls)
        "AiPath": [
          "Heuristic"
          // ML-based heuristic analysis
        ],
        // RESPONSE PATH DETECTORS (Post-request)
        // Run AFTER response is sent (zero latency impact)
        // Analyze response behavior, honeypot interactions, error patterns
        "ResponsePath": [
          "ResponseBehavior"
          // Track response patterns for learning
        ],
        // ORCHESTRATION SETTINGS

        // Use fast path before slow path
        "UseFastPath": true,
        // Force slow path even if fast path is conclusive
        // Set to true for high-security endpoints
        "ForceSlowPath": false,
        // Escalate to AI when uncertainty is high
        "EscalateToAi": true,
        // Risk threshold to trigger AI escalation (0.0-1.0)
        // 0.6 = escalate when 60% confident it's a bot but not certain
        "AiEscalationThreshold": 0.6,
        // Risk threshold for early exit (allow without slow path)
        // 0.3 = if risk <30%, skip slow path and allow immediately
        "EarlyExitThreshold": 0.3,
        // Risk threshold for immediate block (skip slow path)
        // 0.95 = if risk >95%, block immediately without further analysis
        "ImmediateBlockThreshold": 0.95,
        // Default action policy for this detection policy
        "ActionPolicyName": "block",
        // DYNAMIC POLICY TRANSITIONS
        // Automatically switch action policies based on risk level
        "Transitions": [
          {
            // Very high risk (>95%) - immediate hard block
            "WhenRiskExceeds": 0.95,
            "ActionPolicyName": "block-hard"
          },
          {
            // High risk (>70%) - standard block with logging
            "WhenRiskExceeds": 0.7,
            "ActionPolicyName": "block"
          },
          {
            // Medium risk (>50%) - throttle/rate limit
            "WhenRiskExceeds": 0.5,
            "ActionPolicyName": "throttle"
          },
          {
            // Low risk (<30%) - log only, allow through
            "WhenRiskBelow": 0.3,
            "ActionPolicyName": "logonly"
          }
        ],
        "Tags": [
          "production",
          "blocking",
          "learning",
          "ai-escalation"
        ]
      }
    },
    // ==========================================
    // ACTION POLICIES
    // ==========================================
    // Define WHAT HAPPENS when a bot is detected
    // These are referenced by detection policies via ActionPolicyName

    "ActionPolicies": {
      "block-hard": {
        "Description": "Immediate block for very high risk (>95% confidence)",
        "BlockAction": {
          "Enabled": true,
          "StatusCode": 403,
          "Body": "Access denied"
        },
        "LogAction": {
          "Enabled": true,
          "LogLevel": "Warning",
          "IncludeSignature": true
        }
      },
      "block": {
        "Description": "Block suspected bots (70-95% confidence)",
        "BlockAction": {
          "Enabled": true,
          "StatusCode": 403,
          "Body": "Access denied - bot detected"
        },
        "LogAction": {
          "Enabled": true,
          "LogLevel": "Information",
          "IncludeSignature": true
        }
      },
      "throttle": {
        "Description": "Rate limit suspicious traffic (50-70% confidence)",
        "ThrottleAction": {
          "Enabled": true,
          "MaxRequests": 10,
          "WindowSeconds": 60
        },
        "LogAction": {
          "Enabled": true,
          "LogLevel": "Information",
          "IncludeSignature": false
        }
      },
      "logonly": {
        "Description": "Log but allow low-risk traffic (<30% confidence)",
        "AllowAction": {
          "Enabled": true
        },
        "LogAction": {
          "Enabled": true,
          "LogLevel": "Debug",
          "IncludeSignature": false
        }
      }
    }
  }
}
