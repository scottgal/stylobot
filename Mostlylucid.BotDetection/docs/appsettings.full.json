{
  // ===========================================
  // FULL CONFIGURATION REFERENCE
  // ===========================================
  // This file documents ALL available options with their defaults.
  // Copy the sections you need to your appsettings.json.
  //
  // IMPORTANT: This file is for reference only - don't use it as-is!
  // Most applications should use the minimal or typical configuration.
  // ===========================================

  // ===========================================
  // LOGGING CONFIGURATION
  // ===========================================
  // Default: Information to console, Warning to files
  // This gives visibility during development while keeping log files clean

  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      // Bot detection logging - Information by default
      // Set to "Warning" to reduce console noise in production
      // Set to "Debug" for troubleshooting
      // Set to "None" to disable all bot detection logging
      "Mostlylucid.BotDetection": "Information"

      // Fine-grained control (optional - uncomment if needed)
      // "Mostlylucid.BotDetection.Services.BotDetectionService": "Debug",
      // "Mostlylucid.BotDetection.Services.BotListUpdateService": "Information",
      // "Mostlylucid.BotDetection.Data.BotListDatabase": "Warning",
      // "Mostlylucid.BotDetection.Middleware": "Information"
    },
    // Console: Information level (recommended default)
    "Console": {
      "LogLevel": {
        "Default": "Information",
        "Mostlylucid.BotDetection": "Information"
      }
    }

    // Uncomment for file logging at Warning level:
    // "File": {
    //   "LogLevel": {
    //     "Default": "Warning",
    //     "Mostlylucid.BotDetection": "Warning"
    //   }
    // }
  },
  "BotDetection": {
    // ===========================================
    // CORE DETECTION SETTINGS
    // ===========================================

    // Confidence threshold above which a request is classified as a bot
    // Valid range: 0.0 to 1.0
    // Lower = more aggressive (more false positives)
    // Higher = more conservative (may miss some bots)
    // Default: 0.7 (recommended for most use cases)
    "BotThreshold": 0.7,
    // Enable test mode header (ml-bot-test-mode) for simulating bots
    // WARNING: Only enable in development/testing environments!
    // In production, this header is completely ignored for security
    // Default: false
    "EnableTestMode": false,
    // ===========================================
    // DETECTION STRATEGY TOGGLES
    // ===========================================
    // Enable/disable individual detection methods.
    // All are enabled by default for comprehensive protection.

    // User-Agent pattern matching (fastest, always recommended)
    // Matches against known bot signatures from multiple sources
    // Default: true
    "EnableUserAgentDetection": true,
    // HTTP header analysis (low overhead)
    // Detects missing Accept-Language, suspicious Accept headers, etc.
    // Default: true
    "EnableHeaderAnalysis": true,
    // IP-based detection (checks against cloud provider ranges)
    // Identifies traffic from AWS, Azure, GCP, Oracle Cloud
    // Default: true
    "EnableIpDetection": true,
    // Behavioral analysis (request rate monitoring)
    // Tracks requests per IP over time
    // Default: true
    "EnableBehavioralAnalysis": true,
    // LLM-based detection using Ollama (most advanced)
    // Requires Ollama to be running with the specified model
    // Higher latency but can detect sophisticated bots
    // Default: false
    "EnableLlmDetection": false,
    // ===========================================
    // BLOCKING POLICY SETTINGS
    // ===========================================
    // Configure automatic blocking behavior.
    // For fine-grained control, use [BlockBots] attributes on endpoints.

    // Enable automatic blocking of detected bots
    // When false, bots are detected and logged but not blocked
    // Default: false (detection only)
    "BlockDetectedBots": false,
    // HTTP status code when blocking bots
    // Common: 403 (Forbidden), 429 (Too Many Requests), 503 (Service Unavailable)
    // Default: 403
    "BlockStatusCode": 403,
    // Message in response body when blocking
    // Default: "Access denied"
    "BlockMessage": "Access denied",
    // Minimum confidence to actually block (when BlockDetectedBots is true)
    // Set higher than BotThreshold for conservative blocking
    // Default: 0.8
    "MinConfidenceToBlock": 0.8,
    // Allow verified search engines (Googlebot, Bingbot) even when blocking
    // Recommended: true (for SEO)
    // Default: true
    "AllowVerifiedSearchEngines": true,
    // Allow social media preview bots (Facebook, Twitter, LinkedIn)
    // Default: true
    "AllowSocialMediaBots": true,
    // Allow monitoring bots (UptimeRobot, Pingdom)
    // Default: true
    "AllowMonitoringBots": true,
    // ===========================================
    // AI DETECTION SETTINGS (Heuristic or Ollama)
    // ===========================================
    // Only used when EnableLlmDetection is true.
    // Choose between Heuristic (fast, learns) or Ollama (LLM, full reasoning).

    "AiDetection": {
      // Provider: "Heuristic" (fast, learns) or "Ollama" (LLM)
      // Heuristic: Feature-weighted classification, <1ms, continuous learning
      // Ollama: Full LLM reasoning, 50-500ms, best for complex cases
      "Provider": "Heuristic",
      // Timeout for AI detection in milliseconds
      // Valid range: 100 to 30000. Default: 2000
      "TimeoutMs": 2000,
      // Maximum concurrent AI requests
      // Default: 5
      "MaxConcurrentRequests": 5,
      // -----------------------------------------
      // HEURISTIC SETTINGS (when Provider is "Heuristic")
      // -----------------------------------------
      "Heuristic": {
        // Enable heuristic detection
        "Enabled": true,
        // Load learned weights from database on startup
        "LoadLearnedWeights": true,
        // Enable continuous weight learning from detection feedback
        "EnableWeightLearning": true,
        // Minimum confidence to use for weight updates
        "MinConfidenceForLearning": 0.8,
        // Learning rate for weight adjustments (0.01 to 0.1)
        "LearningRate": 0.01,
        // How often to reload weights from store (minutes)
        "WeightReloadIntervalMinutes": 60
      },
      // -----------------------------------------
      // OLLAMA SETTINGS (when Provider is "Ollama")
      // -----------------------------------------
      "Ollama": {
        // Ollama API endpoint
        "Endpoint": "http://localhost:11434",
        // Model to use for bot detection
        // Default: "gemma3:4b" (4B params, 8K context, good reasoning)
        // Alternatives:
        //   "gemma3:1b" - Smaller, faster, less accurate
        //   "qwen2.5:1.5b" - Good reasoning, slightly larger
        //   "phi3:mini" - Microsoft's small model
        //   "tinyllama" - Very small, basic classification
        //   "llama3.2:1b" - Meta's smallest model
        "Model": "gemma3:4b",
        // Use JSON mode for structured output (recommended)
        "UseJsonMode": true,
        // Custom prompt for bot detection (optional)
        // Use {REQUEST_INFO} as placeholder for request data
        // If null/empty, uses the default compact prompt (~350 tokens)
        "CustomPrompt": null
      }
    },
    // ===========================================
    // LEGACY OLLAMA SETTINGS (use AiDetection instead)
    // ===========================================
    // Kept for backwards compatibility. New deployments should use AiDetection section.

    // [LEGACY] Use AiDetection.Ollama.Endpoint instead
    "OllamaEndpoint": "http://localhost:11434",
    // [LEGACY] Use AiDetection.Ollama.Model instead
    // Default changed to "gemma3:4b" (good reasoning, 8K context)
    "OllamaModel": "gemma3:4b",
    // [LEGACY] Use AiDetection.TimeoutMs instead
    "LlmTimeoutMs": 15000,
    // [LEGACY] Use AiDetection.MaxConcurrentRequests instead
    "MaxConcurrentLlmRequests": 5,
    // ===========================================
    // BEHAVIORAL ANALYSIS SETTINGS
    // ===========================================

    // Maximum requests per IP per minute
    // Requests above this increase bot confidence score
    // Valid range: 1 to 10000
    // Default: 60
    "MaxRequestsPerMinute": 60,
    // Time window for behavioral tracking (seconds)
    // Default: 60
    "BehavioralWindowSeconds": 60,
    // Advanced behavioral analysis configuration
    // Enables tracking at multiple identity levels (fingerprint, API key, user ID)
    "Behavioral": {
      // HTTP header name to extract API key from
      // Example: "X-Api-Key", "Authorization"
      // Leave null to disable API key tracking
      // Default: null
      "ApiKeyHeader": null,
      // Rate limit per API key per minute
      // If 0, defaults to MaxRequestsPerMinute * 2
      // Default: 0
      "ApiKeyRateLimit": 0,
      // Claim name to extract user ID from for per-user rate limiting
      // Example: "sub", "nameidentifier", "userId"
      // Used when User.Identity.IsAuthenticated is true
      // Default: null
      "UserIdClaim": null,
      // HTTP header name for user ID (fallback when not authenticated)
      // Example: "X-User-Id"
      // Leave null to disable header-based user tracking
      // Default: null
      "UserIdHeader": null,
      // Rate limit per authenticated user per minute
      // If 0, defaults to MaxRequestsPerMinute * 3
      // Default: 0
      "UserRateLimit": 0,
      // Enable behavior anomaly detection (sudden request spikes, unusual path access)
      // Detects when an identity suddenly changes behavior patterns
      // Default: true
      "EnableAnomalyDetection": true,
      // Threshold multiplier for detecting request spikes
      // A spike is detected when current rate exceeds average * this multiplier
      // Default: 5.0 (5x the normal rate)
      "SpikeThresholdMultiplier": 5.0,
      // Threshold for new path access rate to consider anomalous
      // Range: 0.0-1.0. If 80%+ of recent requests are to new paths, flag as anomaly
      // Default: 0.8
      "NewPathAnomalyThreshold": 0.8
    },
    // ===========================================
    // CACHING SETTINGS
    // ===========================================

    // Cache duration for detection results (seconds)
    // Valid range: 0 to 86400 (24 hours)
    // Set to 0 to disable (not recommended for production)
    // Default: 300 (5 minutes)
    "CacheDurationSeconds": 300,
    // Maximum cached detection results
    // Prevents memory exhaustion
    // Default: 10000
    "MaxCacheEntries": 10000,
    // ===========================================
    // BACKGROUND UPDATE SERVICE SETTINGS
    // ===========================================
    // Controls automatic bot list updates.

    // Enable background updates of bot lists
    // When false, lists are only loaded once at startup
    // Default: true
    "EnableBackgroundUpdates": true,
    // Interval between list updates (hours)
    // Valid range: 1 to 168 (1 week)
    // Default: 24
    "UpdateIntervalHours": 24,
    // Interval between update checks (minutes)
    // How often the service checks if an update is needed
    // Valid range: 5 to 1440
    // Default: 60
    "UpdateCheckIntervalMinutes": 60,
    // Timeout for downloading lists (seconds)
    // Default: 30
    "ListDownloadTimeoutSeconds": 30,
    // Maximum retries for failed downloads
    // Default: 3
    "MaxDownloadRetries": 3,
    // Delay startup initialization (seconds)
    // Avoids slowing application startup
    // Default: 5
    "StartupDelaySeconds": 5,
    // ===========================================
    // EXTERNAL DATA SOURCES
    // ===========================================
    // Configure all external URLs used for bot detection.
    // Each source can be individually enabled/disabled with custom URLs.
    // This allows complete control over what data is fetched and from where.

    "DataSources": {
      // -----------------------------------------
      // BOT PATTERN SOURCES (User-Agent matching)
      // -----------------------------------------

      // IsBot - The primary and most comprehensive source
      // Aggregates patterns from: crawler-user-agents, matomo, myip.ms, and more
      // https://github.com/omrilotan/isbot
      "IsBot": {
        "Enabled": true,
        "Url": "https://raw.githubusercontent.com/omrilotan/isbot/main/src/patterns.json",
        "Description": "IsBot patterns - comprehensive bot regex patterns (JSON array)"
      },
      // Matomo Device Detector - Provides categorized patterns with metadata
      // Note: IsBot already includes these patterns. Enable if you need category info.
      // https://github.com/matomo-org/device-detector
      "Matomo": {
        "Enabled": false,
        "Url": "https://raw.githubusercontent.com/matomo-org/device-detector/master/regexes/bots.yml",
        "Description": "Matomo Device Detector - categorized bot patterns with metadata (YAML)"
      },
      // crawler-user-agents - Community-maintained list
      // Note: IsBot already includes these patterns.
      // https://github.com/monperrus/crawler-user-agents
      "CrawlerUserAgents": {
        "Enabled": false,
        "Url": "https://raw.githubusercontent.com/monperrus/crawler-user-agents/master/crawler-user-agents.json",
        "Description": "Crawler User Agents - community-maintained crawler patterns (JSON)"
      },
      // -----------------------------------------
      // IP RANGE SOURCES (Datacenter detection)
      // -----------------------------------------

      // AWS IP ranges - Official Amazon list, updated frequently
      // https://docs.aws.amazon.com/general/latest/gr/aws-ip-ranges.html
      "AwsIpRanges": {
        "Enabled": true,
        "Url": "https://ip-ranges.amazonaws.com/ip-ranges.json",
        "Description": "AWS IP ranges - official Amazon cloud IP ranges (JSON)"
      },
      // Google Cloud IP ranges - Official GCP list
      // https://cloud.google.com/compute/docs/faq#find_ip_range
      "GcpIpRanges": {
        "Enabled": true,
        "Url": "https://www.gstatic.com/ipranges/cloud.json",
        "Description": "Google Cloud IP ranges - official GCP IP ranges (JSON)"
      },
      // Azure IP ranges - Official Microsoft list
      // IMPORTANT: URL changes weekly! Download from:
      // https://www.microsoft.com/en-us/download/details.aspx?id=56519
      // Then update the URL below with the direct download link
      "AzureIpRanges": {
        "Enabled": false,
        "Url": "",
        "Description": "Azure IP ranges - URL changes weekly, requires manual update"
      },
      // Cloudflare IPv4 ranges - Official Cloudflare list
      // https://www.cloudflare.com/ips/
      "CloudflareIpv4": {
        "Enabled": true,
        "Url": "https://www.cloudflare.com/ips-v4",
        "Description": "Cloudflare IPv4 ranges - official Cloudflare IPs (text, one CIDR per line)"
      },
      // Cloudflare IPv6 ranges
      "CloudflareIpv6": {
        "Enabled": true,
        "Url": "https://www.cloudflare.com/ips-v6",
        "Description": "Cloudflare IPv6 ranges - official Cloudflare IPs (text, one CIDR per line)"
      },
      // -----------------------------------------
      // SECURITY TOOL SOURCES (Malicious scanner detection)
      // -----------------------------------------

      // digininja/scanner_user_agents - Security scanner User-Agents
      // Contains patterns for Nikto, Nessus, SQLMap, WPScan, Acunetix, etc.
      // JSON format with tool metadata (name, category)
      // https://github.com/digininja/scanner_user_agents
      "ScannerUserAgents": {
        "Enabled": true,
        "Url": "https://raw.githubusercontent.com/digininja/scanner_user_agents/main/list.json",
        "Description": "Security scanner user agents - JSON with tool metadata"
      },
      // OWASP CoreRuleSet scanner patterns
      // Community-maintained list used by ModSecurity WAF
      // Text format, one pattern per line (supports regex)
      // https://github.com/coreruleset/coreruleset
      "CoreRuleSetScanners": {
        "Enabled": true,
        "Url": "https://raw.githubusercontent.com/coreruleset/coreruleset/main/rules/scanners-user-agents.data",
        "Description": "OWASP CoreRuleSet scanner patterns - text format"
      }
    },
    // ===========================================
    // PATTERN LEARNING SETTINGS (EXPERIMENTAL)
    // ===========================================
    // Automatic learning of new bot patterns.

    // Enable pattern learning
    // Default: false
    "EnablePatternLearning": false,
    // Minimum confidence to learn a pattern
    // Default: 0.9
    "MinConfidenceToLearn": 0.9,
    // Maximum learned patterns to store
    // Default: 1000
    "MaxLearnedPatterns": 1000,
    // Consolidation/cleanup interval (hours)
    // Default: 24
    "PatternConsolidationIntervalHours": 24,
    // ===========================================
    // DATABASE SETTINGS
    // ===========================================

    // Path to SQLite database
    // Default: {AppContext.BaseDirectory}/botdetection.db
    "DatabasePath": null,
    // Enable WAL mode for better concurrency
    // Default: true
    "EnableDatabaseWalMode": true,
    // ===========================================
    // WHITELISTS AND CUSTOMIZATION
    // ===========================================

    // Known good bots (won't be flagged)
    // Default: ["Googlebot", "Bingbot", "Slackbot", "DuckDuckBot", ...]
    "WhitelistedBotPatterns": [
      "Googlebot",
      "Bingbot",
      "Slackbot",
      "DuckDuckBot",
      "Baiduspider",
      "YandexBot",
      "Sogou",
      "Exabot",
      "facebot",
      "ia_archiver"
    ],
    // Datacenter IP ranges (CIDR notation)
    // Default includes AWS, Azure, GCP, Oracle ranges
    "DatacenterIpPrefixes": [
      "3.0.0.0/8",
      "13.0.0.0/8",
      "18.0.0.0/8",
      "52.0.0.0/8",
      "20.0.0.0/8",
      "40.0.0.0/8",
      "104.0.0.0/8",
      "34.0.0.0/8",
      "35.0.0.0/8",
      "138.0.0.0/8",
      "139.0.0.0/8",
      "140.0.0.0/8"
    ],
    // Custom bot patterns to add (regex)
    // Default: []
    "CustomBotPatterns": [],
    // IPs to always allow (bypass detection)
    // Default: []
    "WhitelistedIps": [],
    // IPs to always block
    // Default: []
    "BlacklistedIps": [],
    // ===========================================
    // LOGGING SETTINGS
    // ===========================================

    // Log all requests (verbose, for debugging)
    // Default: false
    "LogAllRequests": false,
    // Log detailed detection reasons
    // Default: true
    "LogDetailedReasons": true,
    // Log performance metrics
    // Default: false
    "LogPerformanceMetrics": false,
    // Log IP addresses (disable for privacy)
    // Default: true
    "LogIpAddresses": true,
    // Log User-Agent strings (disable for privacy)
    // Default: true
    "LogUserAgents": true,
    // ===========================================
    // SECURITY TOOL DETECTION
    // ===========================================
    // Detects security scanners, exploit frameworks, and hacking tools.
    // Part of the security detection layer for identifying malicious reconnaissance.

    "SecurityTools": {
      // Enable security tool detection
      // When enabled, requests from known security tools are flagged as malicious
      // Default: true
      "Enabled": true,
      // Block requests from security tools immediately
      // When false, tools are detected and logged but not blocked
      // Default: true
      "BlockSecurityTools": true,
      // Log security tool detections at Warning level
      // Useful for security monitoring and alerting
      // Default: true
      "LogDetections": true,
      // Custom tool patterns to add to detection (case-insensitive substring match)
      // Use this to add organization-specific or newly discovered tools
      // Default: []
      // Example: ["my-custom-scanner", "internal-pentest-tool"]
      "CustomPatterns": [],
      // Tool patterns to exclude from detection
      // Use this if you need to allow specific security tools (e.g., for authorized pentests)
      // Default: []
      // Example: ["nessus"] - Allow Nessus for internal security scanning
      "ExcludedPatterns": [],
      // Categories of tools to detect
      // By default, all categories are detected (empty list = all)
      // Available categories:
      //   - VulnerabilityScanner: Nikto, Nessus, OpenVAS, Acunetix, etc.
      //   - SqlInjection: sqlmap, Havij, etc.
      //   - ExploitFramework: Metasploit, BeEF, etc.
      //   - WebAppScanner: Burp Suite, OWASP ZAP, w3af, etc.
      //   - CredentialAttack: Hydra, Medusa, etc.
      //   - Reconnaissance: Nmap, Masscan, Shodan, etc.
      //   - Scraper: HTTrack, wget (aggressive), etc.
      // Default: [] (all categories)
      "EnabledCategories": [],
      // Redirect detected security tools to a honeypot endpoint instead of blocking
      // When set, security tool requests are silently redirected to this URL
      // to gather intelligence on attack patterns
      // Leave null to use standard blocking behavior
      // Default: null
      // Example: "/api/honeypot"
      "HoneypotRedirectUrl": null
    },
    // ===========================================
    // PROJECT HONEYPOT HTTP:BL INTEGRATION
    // ===========================================
    // Uses DNS lookups to check IP reputation against Project Honeypot's
    // database of known harvesters, comment spammers, and suspicious visitors.
    // Requires a FREE API key from: https://www.projecthoneypot.org/httpbl_configure.php
    // API documentation: https://www.projecthoneypot.org/httpbl_api.php

    "ProjectHoneypot": {
      // Enable Project Honeypot HTTP:BL lookups
      // Requires AccessKey to be set
      // Default: false (requires API key)
      "Enabled": false,
      // Your Project Honeypot HTTP:BL access key
      // Get a FREE key from: https://www.projecthoneypot.org/httpbl_configure.php
      // Must be 12 lowercase alphanumeric characters
      // IMPORTANT: Store in user secrets, not appsettings.json!
      //   dotnet user-secrets set "BotDetection:ProjectHoneypot:AccessKey" "your12charkey"
      // Default: null
      "AccessKey": null,
      // Threat score threshold above which to consider an IP as high threat
      // Scores range from 0-255 (logarithmic scale)
      // IPs above this threshold trigger early exit as verified bad bot
      // Threat score guidelines:
      //   0-24:   Low threat
      //   25-49:  Medium threat
      //   50-99:  High threat
      //   100+:   Very high threat (rare)
      // Default: 25 (fairly conservative)
      "HighThreatThreshold": 25,
      // Maximum age in days for considering a listing relevant
      // IPs last seen more than this many days ago are given lower weight
      // Default: 90
      "MaxDaysAge": 90,
      // Timeout for DNS lookups in milliseconds
      // DNS lookups should be fast; longer timeouts may indicate network issues
      // Default: 1000 (1 second)
      "TimeoutMs": 1000,
      // Cache duration for lookup results in seconds
      // Results are cached to avoid repeated DNS queries for the same IP
      // Default: 1800 (30 minutes)
      "CacheDurationSeconds": 1800,
      // Skip lookup for local/private IP addresses
      // These won't be in Project Honeypot anyway
      // Default: true
      "SkipLocalIps": true,
      // Treat harvesters (email scrapers) as malicious
      // Default: true
      "TreatHarvestersAsMalicious": true,
      // Treat comment spammers as malicious
      // Default: true
      "TreatCommentSpammersAsMalicious": true,
      // Treat "suspicious" entries as suspicious (not necessarily malicious)
      // Default: true
      "TreatSuspiciousAsSuspicious": true
    },
    // ===========================================
    // CLIENT-SIDE FINGERPRINTING
    // ===========================================
    // Collects browser fingerprint data via JavaScript for headless browser detection.
    // Detects Selenium, Puppeteer, Playwright, PhantomJS, and other automation tools.

    "ClientSide": {
      // Enable client-side fingerprint collection
      // When enabled, injects JavaScript to collect browser fingerprint
      // Default: true
      "Enabled": true,
      // Secret key for fingerprint token validation (HMAC signing)
      // IMPORTANT: Change this in production! Store in user secrets.
      // Default: "change-this-in-production"
      "TokenSecret": "change-this-in-production",
      // Token lifetime in seconds
      // After this time, the fingerprint must be recollected
      // Default: 300 (5 minutes)
      "TokenLifetimeSeconds": 300,
      // Cache duration for fingerprint results in seconds
      // Default: 1800 (30 minutes)
      "FingerprintCacheDurationSeconds": 1800,
      // Collect WebGL fingerprint data
      // Helps detect virtual machines and headless browsers
      // Default: true
      "CollectWebGL": true,
      // Collect Canvas fingerprint data
      // Provides unique browser identification
      // Default: true
      "CollectCanvas": true,
      // Minimum integrity score (0-100) to consider fingerprint valid
      // Lower scores indicate potential automation or spoofing
      // Default: 70
      "MinIntegrityScore": 70,
      // Threshold for headless browser detection (0.0-1.0)
      // Scores above this are flagged as likely headless
      // Default: 0.5
      "HeadlessThreshold": 0.5
    },
    // ===========================================
    // VERSION AGE DETECTION
    // ===========================================
    // Detects outdated browser and OS versions that are suspicious.
    // Legitimate users typically have recent browser versions.

    "VersionAge": {
      // Enable version age detection
      // Default: true
      "Enabled": true,
      // Check browser version freshness
      // Default: true
      "CheckBrowserVersion": true,
      // Check OS version freshness
      // Default: true
      "CheckOsVersion": true,
      // Maximum browser major version age to consider normal
      // Versions older than this are suspicious
      // Default: 10 (allows browsers up to 10 major versions old)
      "MaxBrowserVersionAge": 10
    },
    // ===========================================
    // HEURISTIC/ML DETECTION
    // ===========================================
    // Machine learning-based detection using learned patterns.
    // Faster than LLM, works offline, learns from your traffic.

    "Heuristic": {
      // Enable heuristic detection
      // Default: true
      "Enabled": true,
      // Load learned weights from database at startup
      // Default: true
      "LoadLearnedWeights": true,
      // Enable weight learning from detection results
      // When true, the system learns from high-confidence detections
      // Default: true
      "EnableWeightLearning": true,
      // Minimum confidence to learn a pattern
      // Only detections with this confidence or higher are used for learning
      // Default: 0.8
      "MinConfidenceForLearning": 0.8,
      // Learning rate for weight updates
      // Higher = faster learning but less stable
      // Default: 0.01
      "LearningRate": 0.01,
      // How often to reload learned weights from database (minutes)
      // Default: 60
      "WeightReloadIntervalMinutes": 60
    },
    // ===========================================
    // RESPONSE HEADERS
    // ===========================================
    // Add detection results to response headers for debugging and integration.

    "ResponseHeaders": {
      // Enable response headers with detection results
      // Default: false
      "Enabled": false,
      // Prefix for all bot detection headers
      // Default: "X-Bot-"
      "HeaderPrefix": "X-Bot-",
      // Include policy name in headers
      // Default: true
      "IncludePolicyName": true,
      // Include confidence score in headers
      // Default: true
      "IncludeConfidence": true,
      // Include list of detectors that ran
      // Default: true
      "IncludeDetectors": true,
      // Include processing time in headers
      // Default: true
      "IncludeProcessingTime": true,
      // Include bot name if detected
      // Default: true
      "IncludeBotName": true,
      // Include full JSON detection result (verbose)
      // WARNING: May expose sensitive detection logic
      // Default: false
      "IncludeFullJson": false
    },
    // ===========================================
    // RESPONSE PII MASKING (OPT-IN)
    // ===========================================
    // Controls response mutation for action markers: mask-pii / strip-pii.
    // Disabled by default.

    "ResponsePiiMasking": {
      // Global feature flag
      // Default: false
      "Enabled": false,
      // Auto-apply mask-pii for high-confidence malicious traffic that is still allowed through
      // Default: true
      "AutoApplyForHighConfidenceMalicious": true,
      // Minimum bot probability for auto-apply (0.0-1.0)
      // Default: 0.9
      "AutoApplyBotProbabilityThreshold": 0.9,
      // Minimum confidence for auto-apply (0.0-1.0)
      // Default: 0.75
      "AutoApplyConfidenceThreshold": 0.75
    },
    // ===========================================
    // THROTTLING SETTINGS
    // ===========================================
    // Configures request throttling for detected bots.
    // Adds artificial delay to slow down scrapers.

    "Throttling": {
      // Enable throttling for detected bots
      // Default: false
      "Enabled": false,
      // Minimum confidence to apply throttling
      // Default: 0.5
      "MinConfidenceToThrottle": 0.5,
      // Base delay in milliseconds
      // Default: 1000
      "BaseDelayMs": 1000,
      // Maximum delay in milliseconds
      // Default: 10000
      "MaxDelayMs": 10000,
      // Add random jitter to delay (makes throttling less detectable)
      // Default: true
      "EnableJitter": true,
      // Jitter percentage (0.0-1.0)
      // 0.2 = +/- 20% variation
      // Default: 0.2
      "JitterPercentage": 0.2
    },
    // ===========================================
    // FAST PATH CONFIGURATION
    // ===========================================
    // Controls the synchronous detection pipeline for low-latency responses.
    // FastPath runs first; SlowPath/AiPath run for uncertain requests.

    "FastPath": {
      // Enable fast path detection
      // Default: true
      "Enabled": true,
      // Maximum parallel detectors in fast path
      // Default: 8
      "MaxParallelDetectors": 8,
      // Enable wave parallelism (run detectors in waves by priority)
      // Default: true
      "EnableWaveParallelism": true,
      // Timeout for each wave in milliseconds
      // Default: 500
      "WaveTimeoutMs": 500,
      // Overall fast path timeout in milliseconds
      // Default: 1000
      "FastPathTimeoutMs": 1000,
      // Confidence threshold for early exit (skip remaining detectors)
      // High confidence results exit early to save processing time
      // Default: 0.99
      "EarlyExitThreshold": 0.99,
      // Confidence threshold to skip slow path entirely
      // If fast path is confident enough, slow path is skipped
      // Default: 0.0 (disabled)
      "SkipSlowPathThreshold": 0.0,
      // Confidence threshold to trigger slow path
      // Uncertain results trigger additional detection
      // Default: 0.0 (always run slow path if configured)
      "SlowPathTriggerThreshold": 0.0,
      // Paths that always run full detection (bypass fast path)
      // Default: []
      "AlwaysRunFullOnPaths": [],
      // Slow path detector configuration
      // Defines which detectors run in each wave
      "SlowPathDetectors": [
        {
          "Name": "Heuristic Detector",
          "Signal": "HeuristicClassificationCompleted",
          "ExpectedLatencyMs": 1,
          "Wave": 1,
          "Category": "AI",
          "Weight": 2.0
        },
        {
          "Name": "LLM Detector",
          "Signal": "LlmClassificationCompleted",
          "ExpectedLatencyMs": 500,
          "Wave": 2,
          "Category": "AI",
          "Weight": 2.5
        }
      ]
    },
    // ===========================================
    // DETECTION POLICIES
    // ===========================================
    // Named policies for different detection behaviors.
    // Policies can be assigned to paths via PathPolicies or [BotPolicy] attributes.

    "PathPolicies": {
      // Map URL paths to policy names
      // Supports wildcards: /api/* matches /api/anything
      // Default: {} (all paths use "default" policy)
      "/api/sensitive/*": "strict",
      "/public/*": "relaxed"
    },
    "Policies": {
      // Default policy - balanced detection
      "default": {
        "Description": "Balanced detection for most use cases",
        // Detectors to run in fast path (sync, low latency)
        "FastPath": [
          "FastPathReputation",
          "UserAgent",
          "Header",
          "Ip",
          "SecurityTool",
          "ProjectHoneypot",
          "Behavioral",
          "ClientSide",
          "Inconsistency",
          "VersionAge",
          "ReputationBias",
          "Heuristic"
        ],
        // Detectors to run in slow path (sync, higher latency)
        "SlowPath": [],
        // AI detectors for escalation
        "AiPath": [
          "Llm",
          "HeuristicLate"
        ],
        // Use fast path for initial detection
        "UseFastPath": true,
        // Force slow path even if fast path is confident
        "ForceSlowPath": false,
        // Escalate uncertain requests to AI
        "EscalateToAi": true,
        // Confidence threshold to escalate to AI (0 = always)
        "AiEscalationThreshold": 0.0,
        // Confidence threshold for early exit
        "EarlyExitThreshold": 0.85,
        // Confidence threshold to block immediately
        "ImmediateBlockThreshold": 0.95,
        // Tags for filtering/grouping
        "Tags": [
          "production",
          "balanced"
        ]
      },
      // Fast path only - no AI, lowest latency
      "fastpath": {
        "Description": "Fast detection without AI - production latency",
        "FastPath": [
          "FastPathReputation",
          "UserAgent",
          "Header",
          "Ip",
          "SecurityTool",
          "ProjectHoneypot",
          "Behavioral",
          "ClientSide",
          "Inconsistency",
          "VersionAge",
          "ReputationBias",
          "Heuristic"
        ],
        "SlowPath": [],
        "AiPath": [],
        "UseFastPath": true,
        "ForceSlowPath": false,
        "EscalateToAi": false,
        "EarlyExitThreshold": 0.15,
        "ImmediateBlockThreshold": 0.90,
        "Tags": [
          "production",
          "fast",
          "no-ai"
        ]
      },
      // Learning mode - full pipeline, never blocks
      "learning": {
        "Description": "Full pipeline for weight learning - never blocks",
        "FastPath": [],
        "SlowPath": [],
        "AiPath": [],
        "UseFastPath": false,
        "ForceSlowPath": true,
        "EscalateToAi": true,
        "EarlyExitThreshold": 0.0,
        "ImmediateBlockThreshold": 1.0,
        // Run ALL registered detectors regardless of triggers
        "BypassTriggerConditions": true,
        "TimeoutSeconds": 10,
        "Tags": [
          "learning",
          "never-blocks"
        ]
      },
      // Strict policy - aggressive blocking
      "strict": {
        "Description": "Aggressive detection for sensitive endpoints",
        "FastPath": [
          "FastPathReputation",
          "UserAgent",
          "Header",
          "Ip",
          "SecurityTool",
          "ProjectHoneypot",
          "Behavioral",
          "ClientSide",
          "Inconsistency",
          "VersionAge",
          "ReputationBias",
          "Heuristic"
        ],
        "SlowPath": [],
        "AiPath": [
          "Llm",
          "HeuristicLate"
        ],
        "UseFastPath": true,
        "EscalateToAi": true,
        "EarlyExitThreshold": 0.70,
        "ImmediateBlockThreshold": 0.60,
        "DefaultBlockAction": "StatusCode",
        "Tags": [
          "strict",
          "sensitive"
        ]
      },
      // Relaxed policy - minimal detection
      "relaxed": {
        "Description": "Minimal detection for public content",
        "FastPath": [
          "UserAgent",
          "Header",
          "Heuristic"
        ],
        "SlowPath": [],
        "AiPath": [],
        "UseFastPath": true,
        "EscalateToAi": false,
        "EarlyExitThreshold": 0.95,
        "ImmediateBlockThreshold": 0.99,
        "Tags": [
          "relaxed",
          "public"
        ]
      }
    },
    // ===========================================
    // TEST MODE SIMULATIONS
    // ===========================================
    // Bot User-Agent strings for testing (only when EnableTestMode is true).
    // Send header "ml-bot-test-mode: <key>" to simulate that bot type.

    "TestModeSimulations": {
      "human": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
      "googlebot": "Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)",
      "bingbot": "Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)",
      "scrapy": "Scrapy/2.11 (+https://scrapy.org)",
      "curl": "curl/8.4.0",
      "puppeteer": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/120.0.0.0 Safari/537.36",
      "malicious": "sqlmap/1.7 (http://sqlmap.org)",
      "gptbot": "Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko; compatible; GPTBot/1.0; +https://openai.com/gptbot)",
      "claudebot": "ClaudeBot/1.0; +https://anthropic.com",
      "twitterbot": "Twitterbot/1.0",
      "facebookbot": "facebookexternalhit/1.1 (+http://www.facebook.com/externalhit_uatext.php)",
      "uptimerobot": "UptimeRobot/2.0; +http://www.uptimerobot.com/"
    }
  }
}
