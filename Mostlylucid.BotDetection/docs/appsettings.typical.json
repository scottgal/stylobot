{
  // ===========================================
  // TYPICAL CONFIGURATION
  // ===========================================
  // A balanced configuration suitable for most production applications.
  // Enables all heuristic detection with reasonable defaults.
  // Uses IsBot as the primary pattern source (most comprehensive).
  // ===========================================

  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "Mostlylucid.BotDetection": "Information"
    }
  },
  "BotDetection": {
    // --- Core Detection Settings ---
    "BotThreshold": 0.7,
    // Confidence threshold (0.0-1.0)
    "EnableTestMode": false,
    // Only enable in development!

    // --- Detection Strategies (all enabled by default) ---
    "EnableUserAgentDetection": true,
    // Pattern matching against known bots
    "EnableHeaderAnalysis": true,
    // Check for missing/suspicious headers
    "EnableIpDetection": true,
    // Datacenter IP detection
    "EnableBehavioralAnalysis": true,
    // Rate limiting / request patterns
    "EnableLlmDetection": false,
    // Requires Ollama - enable if available
    // --- Response PII Masking (opt-in) ---
    // Used by action policies: mask-pii / strip-pii
    "ResponsePiiMasking": {
      "Enabled": false,
      // Default OFF - enable explicitly when you want response mutation
      "AutoApplyForHighConfidenceMalicious": true,
      "AutoApplyBotProbabilityThreshold": 0.9,
      "AutoApplyConfidenceThreshold": 0.75
    },

    // --- Behavioral Analysis ---
    "MaxRequestsPerMinute": 60,
    // Requests above this increase bot score

    // --- Caching ---
    "CacheDurationSeconds": 300,
    // Cache results for 5 minutes

    // --- Background Updates ---
    "EnableBackgroundUpdates": true,
    // Auto-update bot lists
    "UpdateIntervalHours": 24,
    // Update lists every 24 hours
    "StartupDelaySeconds": 5,
    // Delay to not slow app startup

    // --- Security Tools Detection ---
    // Detects vulnerability scanners, exploit frameworks, etc.
    "SecurityTools": {
      "Enabled": true
      // Detect and block security scanners
    },
    // --- Project Honeypot (optional) ---
    // Requires free API key from: https://www.projecthoneypot.org/httpbl_configure.php
    // Store the key in user-secrets, not here!
    "ProjectHoneypot": {
      "Enabled": false,
      // Enable after adding AccessKey
      "AccessKey": null
      // Set via: dotnet user-secrets set "BotDetection:ProjectHoneypot:AccessKey" "your12charkey"
    },
    // --- Data Sources (defaults shown) ---
    // IsBot is the primary source - it aggregates patterns from multiple sources
    // Security tool sources fetch vulnerability scanner patterns
    "DataSources": {
      "IsBot": {
        "Enabled": true,
        "Url": "https://raw.githubusercontent.com/omrilotan/isbot/main/src/patterns.json"
      },
      "AwsIpRanges": {
        "Enabled": true
      },
      "GcpIpRanges": {
        "Enabled": true
      },
      "CloudflareIpv4": {
        "Enabled": true
      },
      "CloudflareIpv6": {
        "Enabled": true
      },
      // Security tool patterns
      "ScannerUserAgents": {
        "Enabled": true
      },
      "CoreRuleSetScanners": {
        "Enabled": true
      }
    }
  }
}
